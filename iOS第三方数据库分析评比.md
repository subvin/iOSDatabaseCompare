# iOS第三方数据库的初步调研结果：

## 1、经多方考证：iOS应用中，最受欢迎的第三方数据库框架主要有以下几个：  

###1、core data    
###2、YapDatabase    
###3、Realm    
###4、SQLite 3    
###5、FMDB。 


##性能分析：
###各种数据库框架性能分析（时间单位：（秒）在此，以插入数据库中的数据量的多少为例来衡量）：    

| 数据库框架 |Core Data|YapDatabase|Realm|SQLite 3|FMDB|
|---|---|---|---|---|---|
|1条数据时长|0.02 - 0.03|0.002|0.002| 0.007|0.007
|10条数据时长|0.02 - 0.03|0.006|0.002| 0.007| 0.007 |
|100条数据时长|0.02 - 0.04|0.04|0.003 - 0.021|0.01|0.01
|1000条数据时长|0.03 - 0.05|0.27|0.003 - 0.05|0.019|0.02|
|10000条数据时长|0.18 - 0.35|0.94|0.05 - 0.15| 0.12|0.13
|100000条数据时长|2.08 - 2.50 |4.0 - 6.0|0.31 - 0.56 |1.19|1.26|
|1000000条数据时长|24|51.0|2.63 - 2.86|11.0 - 12.0|12.0 - 13.0|


###性能分析总结：    
又上表可以看出，在性能上Realm是最好的一个框架，其次是SQLite 3，可得出如下规律：

#### Realm > SQLite 3 ~= FMDB > Core Data > YapDatabase    


1、Core Data ：对于1 - 1000 条数据范围内的操作几乎看不出明显的差别，基本保持平稳的趋势，当插入的条数，超过一万条时，插入的时间趋近于呈现线性增长。    

2、YapDatabase ：在插入100 条以内的数据性能和Core Data 区别不大，但当插入1000条以上的数据时，和Core Data的性能相比有了愈发的明显。    

3、Realm :在所有的这些数据库框架中，性能极好，1000 条以内的数据同时插入效果极佳和性能排名第二的SQLite 3足足拉开了一个数量级，之后不论再插入多少条数据，性能仍然是遥遥领先，由于之前项目中没用过Realm，若要使用需要再进一步的调研。    

4、SQLite 3:    (非事务性操作（mac 模拟器 4.092580：iphone 82.740420秒)    事务性操作（mac 模拟器 0.05：iphone 0.12秒）)SQLite 3 里面的Api 都是C语言的，接近于底层，效率高。

5、FMDB :FMBD是在SQLite 3基础上做了面向对象的疯转处理，性能和SQLite 3几乎一样，推荐使用。    



##易用分析：

### 各种数据库框架的易用性简述如下
| 数据库框架 | 易用性 |
|---|---|
|Realm|作为这些框架中性能最好的一个数据库框架，在使用Realm 的时候只需要导入Realm框架即可，构建插入对象的时候只需将插入的数据模型都需要直接或间接继承于RLMObject 类，对数据对象的增删改查极其简易，比CoreData还方便，数据的存储不是居于数据库进行的处理。
|SQLite 3.0|所有这些框架中最接近于底层的一个框架，纯C语言Api,在项目中使用的时候，需要引入libsqlite3.0.tbd库,访问数据库的时候是通过数据库句柄访问而非指针，对没学过C语言的人用起来会觉得比较陌生，语法也相对较难，需要注意的C语言问题也会相对较多，不易使用，但对熟悉C语言的人用起来还是挺舒服的。 |
|YapDatabase|使用YapDatabase存取的数据对象都需要遵守<NSCoding>协议，存取对象的时候靠键值对来进行，存取操作也较为简易不用写SQL语句，和Realm。
|Core Data|Core Data是苹果官方提供的一套框架，用来解决对象生命管理、对象关系图管理和持久化等方面相关的问题,通过Core Data管理应用程序的数据模型，可以极大程度减少需编写的代码数量，对数据对象的增删改查都相对比FMDB方便,GitHub 上有一个关于Core Data 的封装的一个很好的库，[MagicalRecord](https://github.com/magicalpanda/MagicalRecord)，极大方便了使用Core Data。
| FMDB |FMDB是对SQLite 3 采用了面向对象的方法进行封装，使用方便，提供了多线程安全的数据库操作，github上更新迭代速度快，功能稳定，相比coredata来说更加灵活和轻量级，是绝大多数iOS开发人员都在使用的一个数据库框架|


###易用性排序
综上以及集合上述各种数据库框架在的使用过程种的具体情况（增删改查的方便性，抛开装载时遇到的坑），对各种库的易用性进行总结得出如下排序：    
###Realm > Core Data (MagicalRecord) > YapDatabase  > FMDB  > SQLite 3    


##使用人数分析

在此，结合github 中各个数据库框架库中的star数目，对各个库的使用人数打分

| 数据库框架 | Github star |
|---|---|
|Realm|8359
|SQLite 3| --- |
|YapDatabase|2601
|Core Data([MagicalRecord](https://github.com/magicalpanda/MagicalRecord))|9603|
| FMDB | 10204 |


### 使用人数结果分析：

FMDB > Core Data > Realm > YapDatabase > SQLite 3    


GitHub 上的Star数目，个人认为比较符合当前各个库的使用使用人数情况，和自己一开始研究的时候预估的结果几乎一模一样，


##各种数据库框架的综合评价：

统计规则：给上述的三种分析分别打分，排第一位的给5 分，第二位的给4分，以此类推。

### 总分 = 易用性 * 20 % + 性能 * 50 % + 使用人数 * 30 % （权重分配可调整）



| 数据库框架 | 易用性 |性能|使用人数| 综合得分|
|---|---|---|---|---|
|Realm|5|5|3|4.4|
|SQLite 3.0|1|4|1|2.9|
|Core Data|2|4|4|3.6
| FMDB |2|4|5|4.3


###结论：综上所述，Realm获得了最终的胜利，FMDB稍逊一筹，Core Data排第三。
### Realm凭借着强大的性能和使用的方便性赢得了最后的胜利，虽然现在的使用人数占据的不是绝大多数，但不可否认，使用Realm进行持久化数据存储将会成为一种趋势。
### Realm 很强大，如若需要在项目中进行使用还将要进行更进一步细致的调研。
